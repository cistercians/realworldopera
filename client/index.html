<html>
  <head>
    <script src='/client/js/mobile-detect.js'></script>
    <!-- Mapbox.js -->
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.js'></script>
    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.0/mapbox-gl-geocoder.min.js"></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.css' rel='stylesheet' />
    <link href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.0/mapbox-gl-geocoder.css' rel='stylesheet' />
    <link href='https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&display=swap' rel='stylesheet'>
    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.4.3/mapbox-gl-draw.js"></script>
    <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.4.3/mapbox-gl-draw.css" type="text/css">

    <style>
      * { box-sizing: border-box; }
      body {
        font-family: 'Fira Code', 'Consolas', 'Monaco', monospace;
        margin: 0;
        width: 100vw;
        height: 100vh;
        background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
        overflow: hidden;
      }
      h1 {color: #64ffda; text-align: center; margin: 0; font-size: 2.5em; text-shadow: 0 0 20px rgba(100, 255, 218, 0.5);}
      h2 {color: #64ffda; text-align: center; margin: 0; font-size: 1.2em; text-shadow: 0 0 10px rgba(100, 255, 218, 0.3);}
      p {display: inline-block; margin: 0; padding: 0;}
      img {max-width: 50%;}
      button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 15px 40px;
        font-size: 1.1em;
        cursor: pointer;
        border-radius: 8px;
        transition: transform 0.2s, box-shadow 0.2s;
      }
      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
      }
      #eye {padding-top: 25%;}
      #home {display: none;}
      #menu {
        width: 100vw;
        position: absolute;
        z-index: 1;
        background: transparent;
        padding: 20px;
      }
      #title {padding-top: 2%;}
      #map {display: none; top: 0; bottom: 0; width: 100vw; height: 100vh; position: absolute;}
      #globe {width: 100vw; height: 100vh; position: absolute;}
      #cli {
        width: 100vw;
        position: absolute;
        bottom: 0;
        z-index: 1;
      }
      #stream {
        height: 25vh;
        background: rgba(0, 0, 0, 0.7);
        width: 100vw;
        position: absolute;
        bottom: 50px;
        overflow-y: auto;
        overflow-x: hidden;
        padding: 10px 15px;
        scroll-behavior: smooth;
        border-top: 1px solid rgba(100, 255, 218, 0.2);
      }
      #in {
        background: rgba(0, 0, 0, 0.7);
        position: absolute;
        bottom: 0;
        width: 100%;
        padding: 10px 15px;
        border-top: 1px solid rgba(100, 255, 218, 0.3);
      }
      #text {
        font-family: 'Fira Code', 'Consolas', 'Monaco', monospace;
        color: #64ffda;
        background: transparent;
        width: calc(100% - 80px);
        border: none;
        outline: none;
        font-size: 14px;
      }
      .line {
        color: #e0e0e0;
        margin: 2px 0;
        padding: 4px 8px;
        display: flex;
        flex-direction: row;
        font-size: 13px;
        line-height: 1.6;
        border-left: 2px solid transparent;
        transition: background 0.2s;
      }
      .line:hover {
        background: rgba(100, 255, 218, 0.05);
        border-left-color: rgba(100, 255, 218, 0.3);
      }
      .info {color: #ffb74d; border-left-color: rgba(255, 183, 77, 0.3);}
      .notif {color: #ef5350; border-left-color: rgba(239, 83, 80, 0.3);}
      .greyout {color: #616161;}
      .highlight {background: rgba(239, 83, 80, 0.2); padding: 4px 8px; border-radius: 4px;}
      .name {
        text-align: right;
        color: #9e9e9e;
        min-width: 70px;
        margin-right: 10px;
      }
      .cursor {
        color: #64ffda;
        font-weight: bold;
        margin-right: 8px;
      }
      .mapboxgl-ctrl-bottom-left {display: none;}
      .mapboxgl-ctrl-bottom-right {display: none;}
      .mapboxgl-popup {opacity: 60%;}
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.2);
      }
      ::-webkit-scrollbar-thumb {
        background: rgba(100, 255, 218, 0.3);
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: rgba(100, 255, 218, 0.5);
      }
      .user {color: #ff9800; font-weight: bold;}
      .project {color: #29b6f6; font-weight: bold;}
      .item {color: #66bb6a; font-weight: bold;}
      
      /* Research Modal Styles */
      #researchModal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.85);
        backdrop-filter: blur(4px);
      }
      #researchModal.active {
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .modal-content {
        background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
        border: 2px solid rgba(100, 255, 218, 0.3);
        border-radius: 8px;
        width: 90%;
        max-width: 800px;
        max-height: 85vh;
        display: flex;
        flex-direction: column;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);
      }
      .modal-header {
        padding: 20px;
        border-bottom: 1px solid rgba(100, 255, 218, 0.2);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .modal-header h2 {
        color: #64ffda;
        margin: 0;
        font-size: 1.5em;
        text-shadow: 0 0 10px rgba(100, 255, 218, 0.3);
      }
      .modal-close {
        background: transparent;
        border: 1px solid rgba(100, 255, 218, 0.3);
        color: #64ffda;
        font-size: 24px;
        width: 36px;
        height: 36px;
        border-radius: 4px;
        cursor: pointer;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
      }
      .modal-close:hover {
        background: rgba(100, 255, 218, 0.1);
        border-color: #64ffda;
        transform: none;
        box-shadow: 0 0 10px rgba(100, 255, 218, 0.3);
      }
      .modal-body {
        padding: 20px;
        overflow-y: auto;
        flex: 1;
      }
      #researchFindingsList {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }
      .finding-item {
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(100, 255, 218, 0.1);
        border-radius: 6px;
        padding: 15px;
        transition: all 0.2s;
      }
      .finding-item:hover {
        border-color: rgba(100, 255, 218, 0.3);
        background: rgba(0, 0, 0, 0.4);
      }
      .finding-item.approved {
        border-color: rgba(102, 187, 106, 0.5);
        background: rgba(102, 187, 106, 0.05);
      }
      .finding-item.rejected {
        border-color: rgba(239, 83, 80, 0.3);
        background: rgba(239, 83, 80, 0.05);
        opacity: 0.6;
      }
      .finding-header {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 10px;
      }
      .finding-type-icon {
        font-size: 1.2em;
      }
      .finding-name {
        color: #64ffda;
        font-weight: bold;
        font-size: 1.1em;
        flex: 1;
      }
      .finding-name a {
        color: #29b6f6;
        text-decoration: underline;
      }
      .finding-name a:hover {
        color: #64ffda;
      }
      .finding-actions {
        display: flex;
        gap: 10px;
      }
      .finding-action-btn {
        background: transparent;
        border: 1px solid;
        padding: 6px 12px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 12px;
        transition: all 0.2s;
        font-family: 'Fira Code', 'Consolas', 'Monaco', monospace;
      }
      .finding-action-btn.approve {
        color: #66bb6a;
        border-color: rgba(102, 187, 106, 0.5);
      }
      .finding-action-btn.approve:hover {
        background: rgba(102, 187, 106, 0.1);
        border-color: #66bb6a;
      }
      .finding-action-btn.reject {
        color: #ef5350;
        border-color: rgba(239, 83, 80, 0.5);
      }
      .finding-action-btn.reject:hover {
        background: rgba(239, 83, 80, 0.1);
        border-color: #ef5350;
      }
      .finding-action-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }
      .finding-meta {
        display: flex;
        gap: 15px;
        margin-bottom: 10px;
        font-size: 12px;
        color: #9e9e9e;
      }
      .finding-confidence {
        color: #ffb74d;
      }
      .finding-status {
        font-weight: bold;
      }
      .finding-status.approved {
        color: #66bb6a;
      }
      .finding-status.rejected {
        color: #ef5350;
      }
      .finding-context {
        color: #e0e0e0;
        font-size: 13px;
        line-height: 1.5;
        margin-top: 10px;
        padding: 10px;
        background: rgba(0, 0, 0, 0.2);
        border-radius: 4px;
        border-left: 2px solid rgba(100, 255, 218, 0.2);
      }
      .finding-source {
        margin-top: 8px;
        font-size: 12px;
      }
      .finding-source a {
        color: #29b6f6;
        text-decoration: underline;
      }
      .finding-source a:hover {
        color: #64ffda;
      }
      .no-findings {
        text-align: center;
        color: #9e9e9e;
        padding: 40px;
        font-size: 14px;
      }
      @media (max-width: 768px) {
        .modal-content {
          width: 95%;
          max-height: 90vh;
        }
        .modal-header h2 {
          font-size: 1.2em;
        }
        .finding-item {
          padding: 12px;
        }
        .finding-actions {
          flex-direction: column;
        }
        .finding-action-btn {
          width: 100%;
        }
      }
    </style>
    <script src="https://unpkg.com/globe.gl@2.44.1/dist/globe.gl.min.js"></script>
    <title>ð“‚€</title>
  </head>

  <body>
    <div id="enterDiv">
      <div id="eye">
        <center><h1>ð“‚€</h1></center>
        <center><button id="enter">ENTER</button></center>
      </div>
    </div>
    <div id="home">
      <div id="menu">
        <h1 id="title"><h1>ð“‚€<h1><h1>R E A L</h1><h2>W O R L D Â· O P E R A</h2>
      </div>
      <div id="cli">
        <div id="stream"></div>
        <div id="in" class="line">
          <p id="time"></p>
          <p class="cursor">â—†</p>
          <input id="text" placeholder="type commands here..."></input>
        </div>
      </div>
      <div id="map"></div>
      <div id="globe"></div>
    </div>
    
    <!-- Research Modal -->
    <div id="researchModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Research Findings</h2>
          <button class="modal-close" id="modalClose">Ã—</button>
        </div>
        <div class="modal-body">
          <div id="researchFindingsList"></div>
        </div>
      </div>
    </div>
    
    <script src="/client/js/globe.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/geolocator/2.1.5/geolocator.js"></script>
    <script src="/client/js/client.js"></script>
    <script src="/client/js/gematria.js"></script>
  </body>
</html>
